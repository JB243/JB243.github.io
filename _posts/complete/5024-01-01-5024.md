## **Windows サーバーにリモート接続する方法**

おすすめ記事 **:** 【オペレーティングシステム】 [オペレーティングシステムの目次](https://jb243.github.io/pages/11771)

---

**1\。 [ステップ 1.** (準備) ポートを開く](#1-step-1-準備-ポートを開く-)

**2\。 [ステップ 2.** (準備) クローズドポート法](#2-ステップ-2-準備-クローズドポート法)

**3\。 [ステップ 3.** (中間プロセス) VPN 構成](#3-step-3-intermediate-process-vpn-configuration)

**4\。 [ステップ 4.** (必須アプリケーションのインストール) RDP (リモート デスクトップ プロトコル)](#4-step-4-required-application-installation-rdc-remote-desktop-protocol)

**5\。 [ステップ 5.** (必須アプリケーションのインストール) SSH (セキュア シェル)](#5-step-5-required-application-installation-ssh-secure-shell)

**6\。 [ステップ 6.** (その他のアプリケーションのインストール) WOL (Wake on LAN)](#6-step-6-other-application-installation-wol-wake-on-lan)

**7\。 [ステップ 7.** サーバー コンピュータの管理](#7-step-7-server-computer-management)

---

<br>

## **1\。ステップ 1.** (準備) ポートを開く

⑴ポート

> ① 下位ノードからリクエストが送信されるチャネル

> ② [受信トラフィック](https://fishpoint.tistory.com/6595#:~:text=and%20outbound%20traffic-) **:** サーバーに流入するトラフィック

>> ○ 例: クライアントがサーバーにファイルをアップロードする場合、サーバーの観点からは受信トラフィックが存在します。

>> ○ 受信トラフィックのほとんどはルーターによってブロックされるため、ポートを開く必要があります

>> ○ ポート開放の場合、送信元はクライアント、宛先はサーバー（ルーター）となり、最終的にはサーバー側で開放されます。

> ③ [アウトバウンドトラフィック](https://fishpoint.tistory.com/6595#:~:text=%EA%B7%B8%EB%A6%BC%20%EB%8F%99%EC%98%81 %EC%83%81%20%EC%97%85%EB%A1%9C%EB%93%9C)- **:** サーバーから送信されるトラフィック

>> ○ 例: サーバーがクライアントにファイルを送信する場合、サーバーの観点からは送信トラフィックが存在します。

>> ○ アウトバウンドトラフィックはルーター上でほぼ常にオープンされています

>> ○ たとえば、クライアントがサーバーからファイルをダウンロードする場合、これは典型的なアウトバウンド トラフィック シナリオです。

> ④サーバーとルーターの両方にポート番号がある

⑵ ポート開放方法

> ① あるノードから別のノードにトラフィックを送信する場合、受信側のノードは受信トラフィックになるためポートを開く必要があります。

⑶ **ステップ 1.** ポートフォワーディング

> ①ルータのポート番号をサーバごとに変更する **:** ポート開放と呼ばれることもあります

>> ○ 例: ユーザーがポート 1234 に接続し、Linux コンピュータがポート 22 (デフォルト ポート) での接続のみを許可する場合、接続を許可するようにポート番号を変更できます。

>> ○ ルーターによっては、すべての IP アドレスを設定できるものとできないものがあります。

⑷ **ステップ 2.** コンピュータ室のポートを開く

> ① セキュリティ上の理由から、コンピュータ室では事前に定義された特定のポート (RDP ポート、3389 など) が閉鎖されています。

> ②その場合はコンピュータ室に問い合わせて必要なポートを開放してください

> ③ 代わりに別のポートが開かれている場合は、[regedit を使用してサーバー コンピューターのリモート アクセス ポート番号を変更](https://apophis0.tistory.com/49)

> ④ 代わりに別のポートを開く場合は、**ステップ 1** でポートを開く必要があります。

<br>

<br>

## **2\。ステップ 2.** (準備) クローズドポート法

⑴ クローズドポート方式

> ①中継サーバーを途中に設置した後は、ユーザーからの送信トラフィックのみを受信するため、ポート開放が不要

⑵ **例 1.** TeamViewer

> ① ログインベースのリモートアクセスプログラム

> ② VPN と同様に動作しますが、VPN を使用しません

> ③ RDP とは異なるプロトコルを使用する可能性がある

> ④ただし、TeamViewerは6文字のパスワードを使用するため、総当たりの方法でハッキングされる可能性があるほどセキュリティが低いです。

⑶ **例 2.** Google Chrome リモート デスクトップ

⑷ **例 3.** ズーム

⑸ **例 4.** Google Meet

⑹ **例 5.** デュオ

⑺ **例 6.** AnyDesk

<br>

<br>

## **3\。ステップ 3.** (中間プロセス) VPN 構成

⑴ VPN（仮想プライベートネットワーク）

> ① セキュリティを確保したプライベートネットワークを構築し、特定の権限のあるユーザーのみがネットワークにアクセスできるようにする

> ② VPN のオン/オフが必要になる場合があり、インターネット速度が若干低下する可能性があります

> ③ VPNであっても通常はポート開放が必要です

> ④ VPN を使用すると、ブロックされた IP アドレス上のサーバーによる接続ブロックを回避できます

> ⑤ 例：Mareel VPN

⑵ **例 1.** ワイヤーガード

⑶ **例 2.** テールスケール **:** WireGuard プロトコル上の UI オーバーレイ

> ① 概要

>> ○ **メリット1.** 無料アカウントでは最大20台のデバイスを登録可能

>> ○ **メリット 2.** セキュリティ上の懸念が少ない

> ② **ステップ 1.** Tailscale をサーバーにインストールし、ログインします

> ③ **ステップ2.** Tailscaleをパソコンにインストールし、同じアカウントでログインします

> ④ **ステップ 3.** Tailscale Web サイトにアクセスし、ログインして各デバイスの VPN 内部 IP を確認します。

> ⑤ **ステップ 4.** コンピューターをサーバーに接続します

>> ○ **ケース 1.** サーバー RDP 接続

>> ○ **ケース 2.** パソコンからの SSH 接続

⑷ **例 3.** [wg-easy](https://github.com/WeeJeWel/wg-easy) **:** UI が含まれたオープンソース プロジェクト

⑸ **例 4.** Windows 提供の VPN による実装

> ① IPTIMEを利用すればできる

> ② サーバーコンピュータには Windows パスワードロックが必要です

<br>

<br>

## **4.ステップ 4.** (必要なアプリケーションのインストール) RDP (リモート デスクトップ プロトコル)

⑴ 概要

> ① GUIサポートによるリモート接続

> ②同時接続数が制限されている

> ③ Windows Home Edition では RDP が動作しません

⑵ **ステップ 1.** RDP のインストール (Linux 固有、必須)

> ① RDP サーバーとクライアントは両方とも Windows 機能に組み込まれており、個別のインストールは不要で、簡単な設定が必要です

> ② RDP は Microsoft プロトコルであるため、Linux 上にサーバーとクライアントを個別にインストールする必要があります

⑶ **ステップ 2.** クライアントと Windows サーバーの接続 (必須)

> ① RDP が Windows ベースであるため、Windows 間のサーバー接続がネイティブで十分にサポートされています

> ② Mac から Windows サーバーへの接続は Microsoft リモート デスクトップ経由で行われます

> ③ RDP のデフォルトのポート番号は 3389 です

<br>

<br>

## **5\。ステップ 5.** (必須アプリケーションのインストール) SSH (セキュア シェル)

⑴ 概要

> ①端末ベースのリモート接続

⑵ **ステップ 1.** [Windows SSH サーバー] のインストール(https://techexpert.tips/ko/windows-ko/windows-ssh-서버-설치/) **:** ステップ 2 およびステップ 3 と比較してください。選択用

> ① Ubuntu などの多くの Linux OS には、SSH サーバーとクライアントがプリインストールされ、設定されています。

> ② Ubuntuと違ってWindowsにSSHをインストールするのは難しい

> ③ SSHサーバーとSSHクライアントは分けて検討する必要がある

⑶ **ステップ 2.** WSL (Windows Subsystem for Linux) のインストール **:** ステップ 1 とステップ 3 を比較して選択してください

> ① WSL は Windows 内の仮想化のようなもので、デュアル OS セットアップとは異なります

> ②Python開発における環境変数やパスの管理にはWSLが有利

> ③ [インストールチュートリアル](https://kimsungjin.tistory.com/590)

⑷ **ステップ 3.** デュアル OS インストール **:** ステップ 1 とステップ 2 を比較して選択してください

⑸ **ステップ 4.** リモートサーバーで SSH が開いているかどうかを確認する

⑹ **ステップ 5.** パソコン（クライアント）に VScode Remote-SSH をインストールする
([リンク 1](https://blog.naver.com/PostView.naver?blogId=ys_blog&logNo=222504541128&parentCategoryNo=&categoryNo=38&viewDate=&isShow PopularPosts=true&from=search),
[リンク 2](https://technote.kr/320#subject2)) **:** 必須

> ① Remote-SSH は Microsoft の公式ソフトウェアであり、性能が保証されています

> ②サーバーアドレスを入力して接続することで、サーバーリソースや開発環境をそのままに、リモートのパソコン上で開発が可能

⑺ **ステップ 6.** パスワード ログインの無効化と RSA キー ログインのみの設定 **:** セキュリティ強化のためのオプション

> ①セキュリティを強化するため

⑻ **ステップ 7.** SSH は、Mobaxterm (無料)、PuTTY などのソフトウェアを使用して簡単に使用できます。

<br>

<br>

## **6\。ステップ 6.** (その他のアプリケーションのインストール) Wake on LAN (WOL)

⑴ リモートで電源をオン/オフするソフトウェア **:** LAN 内に電源機能を提供し、リモートでの電源オン/オフを可能にします。

⑵ 多くのルーターが WOL をサポートしているため、正しく設定されていればスマホアプリを使用して簡単にオンにすることができます

⑶ 物理的に接続されていない VPN 上のサーバーは、WOL を使用してオンまたはオフにすることはできません

⑷ 一般に、サーバーの寿命は過熱の問題がなければ数年であるため、WOL は必要ない可能性があります。

<br>

<br>

＃＃ **7\。ステップ 7.** サーバーコンピュータの管理

⑴ 焼き付きを防ぐため、モニターの電源を切ることをお勧めします。

<br>

---

_入力**:** 2022.08.05 00:28_
